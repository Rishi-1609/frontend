<html>
    <head> 
        <title>HTTP Methods</title>
    </head>
    <body>
        
        <form id = "form" style="align-items: center;"> 
            <table border="6px">
                <tr>
                <td><label for="name">NAME</label></td>
                <td><input id = "name" type="text" name = "name"><br/></td>
                </tr>
                <tr>
                <td><label for="age">AGE</label></td>
                <td><input id="age" type="text" name="age"><br/></td>
                </tr>
                <tr>
                <td><label for="address">ADDRESS</label></td>
                <td><textarea id = "address" rows="5" cols="45"></textarea><br/></td>
                </tr>
                <tr><td colspan = '2'>
                    <input type="submit" name="submit">
                    <button type="button" id = "getBtn" onclick="getMethod()">GET</button>
                    <button type="button" id = "putBtn" onclick="putMethod()">PUT</button>
                    <button type="button" id = "delBtn" onclick="deleteMethod()">DELETE</button>
                </td></tr>
                <br/>
            </table>
        </form>
        
        <p id="getDetails"></p>
        <br/>

        <script>
            document.getElementById("form").addEventListener("submit", async(e) => {
                e.preventDefault();
                const data = {
                    name : document.getElementById("name").value,
                    age : document.getElementById("age").value,
                    address : document.getElementById("address").value
                };
                const res = await fetch("https://express-backend-zwcm.onrender.com/users", {
                    method : "POST",
                    headers : {"Content-Type" : "application/json"},
                    body : JSON.stringify(data)
                });
                const result = await res.json();
                document.getElementById("form").reset();
                console.log(result);
            });

            async function getMethod() {
                document.getElementById("getDetails").innerText = "";
                const res = await fetch('https://express-backend-zwcm.onrender.com/users');
                const data = await res.json();
                if (data.length === 0) {
                    document.getElementById("getDetails").innerText = "No Records";
                    return;
                }
                let n = data.length;
                for (let i = 0; i < n; ++i) {
                    let str = "NAME: " + data[i].name + ", AGE: " + data[i].age + ", ADDRESS: " + data[i].address;
                    document.getElementById("getDetails").innerText += str + "\n";
                }
            }

            async function putMethod() {
                const data = {
                    name : document.getElementById("name").value,
                    age : document.getElementById("age").value,
                    address : document.getElementById("address").value
                };
                const res = await fetch("https://express-backend-zwcm.onrender.com/users", {
                    method : "PUT",
                    headers : {"Content-Type" : "application/json"},
                    body : JSON.stringify(data)
                });
                const result = await res.json();
                document.getElementById("form").reset();
                console.log(result);
            };

            async function deleteMethod() {
                const data = {
                    name : document.getElementById("name").value,
                }
                const res = await fetch('https://express-backend-zwcm.onrender.com/users', {
                    method : "DELETE",
                    headers : {"Content-Type" : "application/json"},
                    body : JSON.stringify(data),
                });
                const result = await res.json();
                document.getElementById("form").reset();
                console.log(result);
            }
        </script>
    
    </body>
</html> 